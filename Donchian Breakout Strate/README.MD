# üöÄ Estrategia Donchian Breakout ‚Äî Pine Script¬Æ v6

**Author:** Joel Pasapera Pinto  
**Language:** Pine Script¬Æ v6  
**License:** [Mozilla Public License 2.0](https://mozilla.org/MPL/2.0/)  
**Copyright:** ¬© JJPP_Joel

---

## üìñ Resumen

**Estrategia Donchian Breakout** es una estrategia en Pine Script¬Æ v6 creada para capturar **rupturas (breakouts)** sobre un canal Donchian desplazado.  
La estrategia coloca una **orden Buy-Stop** en el borde superior del canal exactamente en una **hora objetivo** configurable (minuto 0). La orden permanece activa por un n√∫mero limitado de horas (`validHours`) y se cancela si no se ejecuta. La salida de la posici√≥n larga se realiza mediante la **banda inferior del Donchian** como stop din√°mico.

Recomendado para marcos temporales como **30m** y **1h** (EURUSD, GBPUSD), aunque puede probarse en otros activos ajustando par√°metros y gesti√≥n de riesgo.

---

## ‚öôÔ∏è Par√°metros de entrada

| Par√°metro | Tipo | Descripci√≥n | Valor por defecto |
|-----------|------|-------------|-------------------|
| `donchianLen` | `int` | Longitud del canal Donchian (lookback para m√°ximo/m√≠nimo) | `25` |
| `targetHour` | `int` | Hora del exchange para colocar la orden (minuto 0) | `17` |
| `validHours` | `int` | Horas de validez de la orden (si no se ejecuta, se cancela) | `60` |
| `lot_size` | `int` | Volumen de la posici√≥n (cantidad fija) | `900` |
| `initial_capital` (strategy) | `int` | Capital inicial en backtest | `1000` |
| `default_qty_type` (strategy) | `enum` | Tipo de tama√±o de posici√≥n | `strategy.fixed` |
| `default_qty_value` (strategy) | `float` | Valor por defecto del tama√±o | `1` |

---

## üß† L√≥gica de la estrategia

1. **C√°lculo del Canal Donchian**  
   - `upperBand = ta.highest(high, donchianLen)[1]` ‚Äî m√°ximo de `donchianLen` barras cerradas previas (desplazado con `[1]` para evitar repaint).  
   - `lowerBand = ta.lowest(low, donchianLen)[1]` ‚Äî m√≠nimo equivalente.

2. **Hora objetivo y colocaci√≥n de orden**  
   - En la barra que coincide con `targetHour` y `minute == 0`, se guarda `pendingPrice := upperBand` y se coloca una orden `strategy.entry(..., stop=pendingPrice, qty=lot_size)` (Buy Stop).

3. **Validez de la orden**  
   - Si la orden no se ejecuta en `validHours` (medido en barras desde `entryBarIndex`), la estrategia cancela la orden pendiente (`strategy.cancel("Long Breakout")`).

4. **Salida (exit)**  
   - Si hay una posici√≥n abierta, se aplica `strategy.exit("Exit Long", "Long Breakout", stop=lowerBand)` para cerrar la operaci√≥n cuando el precio toque la banda inferior.

5. **Visualizaci√≥n**  
   - Se plotean `upperBand` y `lowerBand`.  
   - Se pinta el fondo en la barra objetivo y se a√±ade una forma (`plotshape`) indicando la colocaci√≥n de la orden (tri√°ngulo con texto "Buy\nStop").

---

## ‚ö†Ô∏è Consideraciones y recomendaciones

- El uso de `[1]` en los c√°lculos evita se√±ales basadas en la barra en formaci√≥n y reduce repainting.  
- `lot_size` es fijo; se recomienda adaptar a gesti√≥n de riesgo real (porcentaje de capital, `strategy.percent_of_equity`, etc.).  
- Verificar la zona horaria del servidor de TradingView antes de operar en real. `targetHour` corresponde a la hora del exchange/servidor.  
- Incluir comisiones y slippage en backtests para obtener resultados m√°s realistas.  
- Probar en forward-test (paper trading) antes de operar con capital real. Considerar a√±adir filtros (ATR, sesiones, volumen) para mejorar la calidad de se√±ales.

---

## üîß C√≥mo instalar en TradingView

1. Abrir TradingView ‚Üí Pine Editor.  
2. Crear nuevo script y pegar el c√≥digo incluido abajo.  
3. Guardar y a√±adir al gr√°fico. Seleccionar s√≠mbolo y timeframe preferido (ej. `EURUSD 30m / 1h`).  
4. Ejecutar el backtest en la pesta√±a *Strategy Tester* y ajustar par√°metros seg√∫n resultados.

---

## üìä Capturas de ejemplo

- **EURUSD ‚Äî 30 minutos**  
  https://github.com/JoelPasapera/Strategies-in-Pine-Script-v6/blob/3c778c5d461ea458a43bdfcf16dc05c6330881b3/Donchian%20Breakout%20Strate/Screenshot_1.png

- **EURUSD ‚Äî 1 hora**  
  https://github.com/JoelPasapera/Strategies-in-Pine-Script-v6/blob/3c778c5d461ea458a43bdfcf16dc05c6330881b3/Donchian%20Breakout%20Strate/Screenshot_2.png

- **EURUSD ‚Äî 1 hora (otro ejemplo)**  
  https://github.com/JoelPasapera/Strategies-in-Pine-Script-v6/blob/3c778c5d461ea458a43bdfcf16dc05c6330881b3/Donchian%20Breakout%20Strate/Screenshot_3.png

- **GBPUSD ‚Äî 30 minutos**  
  https://github.com/JoelPasapera/Strategies-in-Pine-Script-v6/blob/3c778c5d461ea458a43bdfcf16dc05c6330881b3/Donchian%20Breakout%20Strate/Screenshot_4.png

- **GBPUSD ‚Äî 1 hora**  
  https://github.com/JoelPasapera/Strategies-in-Pine-Script-v6/blob/3c778c5d461ea458a43bdfcf16dc05c6330881b3/Donchian%20Breakout%20Strate/Screenshot_5.png

---
